!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){var n={},o=document.querySelector(".app__snackbar"),a=null;n.show=(e,t=4e3)=>{e&&(a&&a.remove(),(a=document.createElement("div")).className="app__snackbar-msg",a.textContent=e,o.appendChild(a),setTimeout(()=>{a.remove()},t))},t.snackbar=n},function(e,t){e.exports=function(e){if("string"!=typeof e)return!1;var t=e.match(n);if(!t)return!1;var r=t[1];if(!r)return!1;if(o.test(r)||a.test(r))return!0;return!1};var n=/^(?:\w+:)?\/\/(\S+)$/,o=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,a=/^[^\s\.]+\.\S{2,}$/},function(e,t,n){"use strict";var o=n(3),a="Copy to clipboard: #{key}, Enter";e.exports=function(e,t){var n,r,i,c,l,s,d=!1;t||(t={}),n=t.debug||!1;try{if(i=o(),c=document.createRange(),l=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",function(n){n.stopPropagation(),t.format&&(n.preventDefault(),n.clipboardData.clearData(),n.clipboardData.setData(t.format,e))}),document.body.appendChild(s),c.selectNodeContents(s),l.addRange(c),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");d=!0}catch(o){n&&console.error("unable to copy using execCommand: ",o),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),d=!0}catch(o){n&&console.error("unable to copy using clipboardData: ",o),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:a),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(c):l.removeAllRanges()),s&&document.body.removeChild(s),i()}return d}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],o=0;o<e.rangeCount;o++)n.push(e.getRangeAt(o));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach(function(t){e.addRange(t)}),t&&t.focus()}}},function(e,t,n){"use strict";n.r(t);var o=n(0),a={};function r(e){!e&&window.isMediaStreamAPISupported?a.webcam=document.querySelector("video"):a.webcam=document.querySelector("img")}a.active=!1,a.webcam=null,a.canvas=null,a.ctx=null,a.decoder=null,a.setCanvas=()=>{a.canvas=document.createElement("canvas"),a.ctx=a.canvas.getContext("2d")},a.init=()=>{var e=!1;function t(){a.canvas.width=window.innerWidth,a.canvas.height=window.innerHeight}r(),a.setCanvas(),a.decoder=new Worker("decoder.js"),window.isMediaStreamAPISupported?a.webcam.addEventListener("play",function(n){e||(t(),e=!0)},!1):t()},a.camera=e=>{window.isMediaStreamAPISupported&&(window.stream&&window.stream.getVideoTracks()[0].stop(),function(e){navigator.mediaDevices.getUserMedia(e).then(function(e){window.stream=e,a.webcam.srcObject=e,a.webcam.setAttribute("playsinline",!0),a.webcam.setAttribute("controls",!0),setTimeout(()=>{document.querySelector("video").removeAttribute("controls")})}).catch(function(e){console.log("Error occurred ",e),window.noCameraPermission=!0,document.querySelector(".custom-scanner").style.display="none",o.snackbar.show("Caméra inaccessible.",1e4)})}(e))},a.scan=function(e,t){function n(){if(a.active)try{a.ctx.drawImage(a.webcam,0,0,a.canvas.width,a.canvas.height);var e=a.ctx.getImageData(0,0,a.canvas.width,a.canvas.height);e.data&&a.decoder.postMessage(e)}catch(e){"NS_ERROR_NOT_AVAILABLE"==e.name&&setTimeout(n,0)}}a.active=!0,a.setCanvas(),a.decoder.onmessage=function(t){if(t.data.length>0){var o=t.data[0][2];a.active=!1,e(o)}setTimeout(n,0)},setTimeout(()=>{r(t)}),n()};var i=a,c=(n(5),n(1)),l=n.n(c),s=n(2),d=n.n(s);"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("SW registered: ",e),localStorage.getItem("offline")||(localStorage.setItem("offline",!0),o.snackbar.show("Prêt pour un usage hors-ligne.",5e3))}).catch(e=>{console.log("SW registration failed: ",e)})}),window.addEventListener("DOMContentLoaded",()=>{window.iOS=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,window.isMediaStreamAPISupported=navigator&&navigator.mediaDevices&&"enumerateDevices"in navigator.mediaDevices,window.noCameraPermission=!1;var e=null,t=null,n=document.querySelector(".app__add-photo"),o=document.querySelector(".app__remove-photo"),a=document.querySelector(".app__flip-camera"),r=document.querySelector(".app__dialog"),c=document.querySelector(".app__dialog-overlay"),s=document.querySelector(".app__dialog-open"),u=document.querySelector(".app__dialog-copy"),p=document.querySelector(".app__dialog-close"),m=document.querySelector(".custom-scanner"),v=document.querySelector("#result");document.querySelector(".app__help-text"),document.querySelector(".app__header-icon svg"),document.querySelector("video");window.appOverlay=document.querySelector(".app__overlay");var y=null,f=null;function g(t=!1){m.style.display="none",window.isMediaStreamAPISupported&&!window.noCameraPermission&&(m.style.display="block"),t&&(m.style.display="block"),i.scan(t=>{e=t,v.value=t,v.select(),m.style.display="none",l()(t)?(s.style.display="inline-block",u.style.display="none"):(u.style.display="inline-block",s.style.display="none"),r.classList.remove("app__dialog--hide"),c.classList.remove("app__dialog--hide");document.querySelector("#frame")},t)}function w(){e=null,v.value="",o.click(),r.classList.add("app__dialog--hide"),c.classList.add("app__dialog--hide"),g()}function b(){window.isMediaStreamAPISupported?navigator.mediaDevices.enumerateDevices().then(function(e){var t,n=e.filter(function(e){if("videoinput"==e.kind)return e});if(null==y){y=0;for(var o=0;o<n.length;o++)("environment"==n[o].facingMode||n[o].label.indexOf("back")>=0)&&(y=o)}else y<n.length-1?y++:y=0;f=null==f?"environment":"environment"==f?"user":"environment",window.iOS?t={video:{facingMode:f},audio:!1}:n.length>1?t={video:{deviceId:n[y].deviceId},audio:!1}:(a.style.display="none",t={video:!0,audio:!1}),i.camera(t)}):a.style.display="none"}window.addEventListener("load",e=>{i.init(),b(),setTimeout(()=>{window.isMediaStreamAPISupported&&g()},1e3),a.addEventListener("click",()=>{b()}),function(){o.style.display="none",n.style.display="block";var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.id="camera",n.style.display="block",(t=document.createElement("img")).src="",t.id="frame";var a=document.querySelector(".app__layout-content");a.appendChild(e),a.appendChild(t),n.addEventListener("click",()=>{document.querySelector("#camera").click()}),o.addEventListener("click",()=>{e.value="",t.src="",t.className="",o.style.display="none",n.style.display="block",g()}),e.addEventListener("change",e=>{e.target&&e.target.files.length>0&&(t.className="app__overlay",t.src=URL.createObjectURL(e.target.files[0]),o.style.display="block",n.style.display="none",g(!0))})}()}),p.addEventListener("click",w,!1),s.addEventListener("click",function(){console.log("Result: ",e),window.location.href=e,e=null,w()},!1),u.addEventListener("click",function(){console.log("Result: ",e),d()(e),e=null,w()},!1)})},function(e,t){}]);